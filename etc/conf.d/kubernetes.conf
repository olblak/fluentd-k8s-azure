<source>
   type tail 
   tag kubernetes.*
   path /fluentd/log/source/containers/*.log
   pos_file Fluentd-docker.pos
   format json
   read_from_head true
   keep_time_key true
   time_key time
   time_format %Y-%m-%dT%H:%M:%S.%NZ
   log_level KUBERNETES_LOG_LEVEL
</source>

<filter kubernetes.var.log.containers.*.log>
   type kubernetes_metadata
   ca_file /var/run/secrets/kubernetes.io/serviceaccount/ca.crt
   bearer_token_file /var/run/secrets/kubernetes.io/serviceaccount/token
   # By default kubernetes doesn't add CN=10.0.0.1 to his CA
   # so ssl verification will always be failing
   verify_ssl false
</filter>

<match kubernetes.**>
    @type copy
# Uncomment next 'store' if we want send logs locally
#	<store>
#		@type forest
#		subtype file
#		<template>
#			path /fluentd/logs/dest/__TAG__.__HOSTNAME__.*.log
#			compress gzip
#			format json
#		</template>
#	</store>
	<store>
		@type azure-loganalytics
		customer_id CUSTOMER_ID   # Customer ID aka WorkspaceID String
		shared_key KEY_STRING     # The primary or the secondary Connected Sources client authentication key
		log_type Kubernetes # ! Only alpha character, no num!
        log_level KUBERNETES_LOG_LEVEL
	</store>
</match>
